% Зависимость итераций от точности

f1 = figure;

e = [0.010000000000000 0.001000000000000 0.000100000000000 0.000010000000000 0.000001000000000 0.000000100000000 0.000000010000000 0.000000001000000 0.000000000100000 0.000000000010000 0.000000000001000 0.000000000000100 0.000000000000010 0.000000000000001];

% polynom hpm
iter = [5 8 12 15 18 22 25 28 32 35 38 42 45 48];
semilogx(e, iter, "red");
hold on
grid on
% polynom fpi
iter = [2 6 10 14 18 22 24 28 32 36 40 44 48 52];
semilogx(e, iter, "blue");
% complex hpm
iter = [8 11 15 18 21 25 28 31 35 38 41 45 48 51];
semilogx(e, iter, "green");
% complex fpi
iter = [1 2 4 5 6 8 9 10 12 12 14 16 16 18];
semilogx(e, iter, "black");

legend('полином МПД','полином МПИ', 'транс МПД', 'транс МПИ');
title("Зависимость числа итераций от точности");
xlabel("e^-^i");
ylabel("число итераций");
hold off

% Фактическая ошибка

f2 = figure;

rootPoly = 0.3065629648763765278566431734271871535837611883492695275488983669;
rootComplex = -5.8001297200890918399;
rootsPolyHpm = [0.308750000000000 0.306406250000000 0.306552734375000 0.306563720703125 0.306563262939453 0.306562948226929 0.306562966108322 0.306562964767218 0.306562964851037 0.306562964875484 0.306562964876794 0.306562964876384 0.306562964876374 0.306562964876376];
rootsPolyFpi = [0.293256210224558 0.305297282973238 0.306452711630470 0.306553444089607 0.306562143346881 0.306562893992922 0.306562944055234 0.306562963079891 0.306562964721373 0.306562964863002 0.306562964875223 0.306562964876277 0.306562964876368 0.306562964876376];
rootsComplexHpm = [-5.800781250000000 -5.800292968750000 -5.800140380859375 -5.800128936767578 -5.800129413604736 -5.800129741430283 -5.800129722803831 -5.800129720475525 -5.800129720097175 -5.800129720086261 -5.800129720089444 -5.800129720089075 -5.800129720089092 -5.800129720089092 ];
rootsComplexFpi = [-5.902532965757413 -5.799415642675740 -5.800150655859045 -5.800226526042009 -5.800129095927074 -5.800129738688023 -5.800129806054475 -5.800129719534867 -5.800129720105607 -5.800129720105607 -5.800129720088600 -5.800129720089107 -5.800129720089107 -5.800129720089092];

% polynom hpm
loglog(e, abs(rootsPolyHpm - rootPoly), "red");
hold on
grid on
% polynom fpi
loglog(e, abs(rootsPolyFpi - rootPoly), "blue");
% complex hpm
loglog(e, abs(rootsComplexHpm - rootComplex), "green");
% complex fpi
loglog(e, abs(rootsComplexFpi - rootComplex), "black");

legend('полином МПД','полином МПИ', 'транс МПД', 'транс МПИ');
title("Зависимость ln разности с истинным корнем от точности");
xlabel("e^-^i");
ylabel("ln(|x - x^*|)");
hold off